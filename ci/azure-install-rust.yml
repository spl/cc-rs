steps:

  - script: |
      choco install msys2 --no-progress --params="/InstallDir:C:\msys64 /NoUpdate /NoPath"
      @echo ##vso[task.prependpath]C:\msys64\usr\bin
      @echo ##vso[task.prependpath]C:\msys64\mingw%BITS%\bin
    displayName: Install MSYS2

  - script: |
      echo %PATH%
      pacman -Syyuu --noconfirm --noprogressbar --ask 20
      pacman -Syu --noconfirm --noprogressbar
    displayName: Update MSYS2

  - script: |
      pacman -S --noconfirm --noprogressbar --needed mingw-w64-%ARCH%-rust
      where rustc
    displayName: Install mingw-w64-%ARCH%-rust

  - script: |
        rustc -Vv
        cargo -V
    displayName: Query rust and cargo versions
