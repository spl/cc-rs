steps:

  - script: |
      choco install msys2 --params="/InstallDir:%CD:~0,2%\msys64 /NoUpdate /NoPath"
    displayName: Install MSYS2

  - script: |
      @echo ##vso[task.prependpath]%CD:~0,2%\msys64\usr\bin
      pacman -Syyuu --noconfirm --noprogressbar --ask 20
      pacman -Syu --noconfirm --noprogressbar
    displayName: Update MSYS2

  - script: |
      pacman -S --noconfirm --needed mingw-w64-%ARCH%-rust
    displayName: Install mingw-w64-%ARCH%-rust

  - script: |
        @echo ##vso[task.prependpath]%CD:~0,2%\mingw%BITS%\bin
        rustc -Vv
        cargo -V
    displayName: Query rust and cargo versions
