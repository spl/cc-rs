steps:

  - script: |
      choco install msys2 --no-progress --params="/InstallDir:c:\msys64 /NoUpdate /NoPath"
      @echo ##vso[task.prependpath]c:\msys64\usr\bin
    displayName: Install MSYS2

  - script: |
      pacman -Syyuu --noconfirm --noprogressbar --ask 20
      pacman -Syu --noconfirm --noprogressbar
    displayName: Update MSYS2

  - script: |
      pacman -S --noconfirm --needed mingw-w64-%ARCH%-rust
    displayName: Install mingw-w64-%ARCH%-rust

  - script: |
        @echo ##vso[task.prependpath]c:\msys64\mingw%BITS%\bin
        rustc -Vv
        cargo -V
    displayName: Query rust and cargo versions
